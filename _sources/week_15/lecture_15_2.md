# Пятнадцатая лекция, часть 2

Цегодня мы изучим новый тип равновесия, называемое **pавновесием Нэша**, и применим его к задаче финансирования общественного блага.

## Равновесие Нэша

Два преступника ограбили банк, но у шерифа недостаточно доказательств, он может только предьявить им незаконное хранение оружия. Шериф предлагает каждому преступнику сделку - признаться и выйти на свободу, если второй будет молчать. Если оба признаются - срок будет средним, а если никто не признаются, то совсем маленьким. 

Полезности описаны в следующей матрице:

$$ 
\begin{array}{c|ccc}
 & признаться & молчать\\
\hline
признаться  & 1,1  & 3,0\\
молчать  & 0,3  & 2,2
\end{array}
$$

Найдем парето оптимальные точки, это: $(3,0), (2,2), (0,3)$; они максимизирут некоторые взвешенные полезности (угадайте какие).

Однако, равновесием в этой игре принято считать признаться-признаться, поскольку каждому грабителю выгодно сдать своего напарника, независимо от того, что тот будет делать.

:::{prf:definition} 

Равновесием Нэша в игре называют план действия каждого игрока, такие что они являются оптимальными против друг друга.

:::

Рассмотрим игру камень-ножницы-бумага

$$ 
\begin{array}{c|ccc}
 & камень & ножницы & бумага\\
\hline
камень  & 0,0  & 1,-1 & -1,1\\
ножницы  & -1,1  & 0,0 & 1,1\\
бумага  & 1,-1  & -1,1 & 0,0
\end{array}
$$

Равновесием нэша здесь принато считать смешанная стратегия 

$$[1/3] \cdot камень+[1/3] \cdot ножницы+[1/3] \cdot бумага$$

для каждого игрока, поскольку каждый агент безразличен, что играть против такого противника.

:::{prf:Theorem} **Нэша**
:class: remark
Если пространство стратегий выпукло, агентов конечно, а полезности непрерывны и вогнуты, то существует равновесие Нэша.
:::

В частности, пространство смешанных стратегий выпукло а ассоциированные ожидаемые полезности непрерывны и вогнуты.

## Трагедии общин

При помощи равновесия Нэша удобно исследовать феномен чрезмерного расходования общественных благ.

### Два рыбака

Предположим, что каждый рыбак выбирает время $x$ которое он потратит на вылов рыбы. Каждый рыбак полычит $x_i(100-x_1-x_2)$ килограммов рыбы и продаст их по $p$ рублей за килограмм. 

В равновесии нэша каждый игрок максимизирует свою полезность по своему (но не чужому) действию

$$ U_1(x_1) = p x_1(100-x_1-x_2), \ U_2(x_2) = p x_2(100-x_1-x_2)$$

Поскольку каждая задача выпуклая, то в равновесии $x^{\ast}_1, x^{\ast}_2$ должны быть выполнены условия первого порядка:

$$ 0 = p (100-2 x_1-x_2), \ 0 = p (100-x_1-2x_2)$$

Суммируя их мы получаем 

$$ 0 = p (200-3 x_1-3x_2) \quad \Rightarrow \quad x_1 + x_2 = 200/3$$

Наконец, 

$$x^{\ast}_1 = 300/3 - x_1 - x_2 = 100/3$$

и аналогично

$$x^{\ast}_2 = 300/3 - x_1 - x_2 = 100/3$$

а суммарный вылов равен

$$X^{\ast} = x^{\ast}_1 + x^{\ast}_2 = 200/3.$$

А какой обьем максимизоровал бы сумму полезностей?

$$ p(x_1 + x_2)(100 - x_1 - x_2) \to \max_{x_1, x_2} $$

$$ p X (100 - X) \to \max_{X} $$

Получается, что суммарный оптимальный вылов равен $200/4$, что гораздо меньше чем $200/3$. Таким образом, мы показали, что равновесие нэша перерасходует общественное благо (пруд).

### $n$ рыбаков

Выпишем полезности:

$$ U_i(x_i) = p x_i(100-X), \ i = 1, \ldots, n, \ X = \sum x_i$$

Выпишем условия первого порядка:

$$ x_i = 100 - X, \ i = 1, \ldots, n$$

Сложим их вместе и посчитаем равновесие:

$$ X = n (100 - X) \quad \Rightarrow \quad X^{\ast} = \frac{100 n}{n+1} \quad \Rightarrow \quad x^{\ast}_i = \frac{100}{n+1}.$$

А оптимальное $X$ по прежнему равно $100/2$. Более того, легко видеть, что суммарная полезность агентов в равновесии Нэша стремится к нулю, когда $n \to \infty$.

$$ \sum U^{\ast} = p 100^2 \frac{n}{(n+1)^2} \to 0$$

### Мельницы

Рыночный спрос можно считать примером общественного блага, которое можно неаккуратно перерасходовать. Предположим, что $n$ мельниц поставляют муку в город, а спрос на муку описивается уравнением $$ P(Q) = 100- Q, \quad Q = \sum_j q_j.$$

Также, издержки на производство муки равны $c_i q_i$. Таким образом, полезность каждого агента:

$$ U_i(q_i) = (100 - Q)q_i - c_i q_i$$

:::{dropdown} Найдем равновесие Нэша

Выпишем условия первого порядка

$$100 - Q - q_i - c_i = 0.$$

$$q_i = 100 - Q - c_i$$

Просуммируем

$$ Q = n(100 - Q) - \sum c_j$$

$$ Q = \frac{100n - \sum_j c_j}{n+1} = \frac{\sum_j(100 - c_j)}{n+1}$$

$$ q_i = (100 - c_i) - \frac{\sum_j (100 - c_j)}{n+1}$$

:::

:::{dropdown} Найдем оптимальный выпуск

Запишем суммарную полезнось как

$$ 
\sum_i (100- Q - c_i)q_i
$$ 

Выпишем условия первого порядка

$$q_i = 100 - Q - c_i - \sum_j q_j = 100 - 2Q - c_i$$

Просуммируем

$$ (2n + 1)Q = 100n - \sum_j c_i$$

Получаем

$$ Q = \frac{\sum_j (100 - c_j)}{2n + 1}$$

:::

## Добровольное финансирование

Для простоты, пусть одна специальная фирма $j^{\ast}$ занимается производством одного общественного блага из частных.

:::{prf:definition} 

Равновесием Вальраса с добровольным финансированием это $(\vec p, \vec x, \vec y, z, \vec t)$, где $z$-общественное благо, такие что
- $(\vec x, \vec y, z)$ это допустимое состояние экономики
- каждый агент $i$ делает взнос $t_i$ на производство общ. блага, который является наилучшим ответом на взносы других агентов
- каждый производитель частного блага $y$ максимизирует прибыль, а доли фирм распределены между агентами
- специальная фирма тратит все взносы на производство общественного блага, согласно своей (эффективной) технологии, то есть, ее прибыль равна нулю.

:::

### Посчитаем неизвестные

Неизвестных:
- $K-1$ цен частных благ
- $(I+J) \cdot K$ координат потребления и производства
- $I+J$ множителей Лагранжа
- $I$ добровольных взносов
- $1$ координата общественного блага

### Посчитаем уравнения

Уравнений:
- $K$ товарных равенств
- $(I+J) \cdot K$ стандартных условой первого порядка
- $I-1$ законов вальраса 
- $J$ условой оптимальности фирм
- $I$ дополнительных условий первого порядка
- прибыль специальной фирмы равна нулю


### Как решать?

Я рекомендую подставлять технологию производства общественного блага прямиком в полезность агента, например...
- есть одно частное благо $x$ (его производство обозначим  $y$) и одно общественное благо $z$
- есть два агента с одинаковыми полезностями $\log x + z$
- у каждого агента единица частного блага
- фирма производит общественное благо по технологии
$$ z = \log(-y), \quad -y p = t_1 + t_2$$


:::{dropdown} Попробуем...

Запишем полезность первого агента:
$$ \log x_1 + \log(\frac{t_1 + t_2}{p}) \to \max_{x_1,t_1}, \quad p x_1 + t_1 \leqslant p$$

или

$$ \log(\frac{p-t_1}{p}) + \log(\frac{t_1 + t_2}{p}) \to \max_{t_1}$$

Запишем полезность второго агента:
$$ \log x_2 + \log(\frac{t_1 + t_2}{p}) \to \max_{x_2,t_2}, \quad p x_2 + t_2 \leqslant p$$

или

$$ \log(\frac{p-t_2}{p}) + \log(\frac{t_1 + t_2}{p}) \to \max_{t_2}$$

Заметьте, что мы воспользовались двумя законами вальраса, поэтому нам уже не понадобится единственное товарное равенство: $x_1 + x_2 + y = 2$ .

Далее оптимизируем по $t_1, t_2$, получаем

$$ \frac{1}{p-t_1} = \frac{1}{t_1 + t_2} = \frac{1}{p-t_2}$$

или 

$$ p-t_1 = t_1 + t_2 = p-t_2$$

что попросту значит

$$ T = t_1 + t_2 = 2 p /3, \quad t_1 = t_2 = p - T = p/3.$$

:::

Далее, по законам вальраса $x_1 = x_2 = 2/3$ и значит $y = -2/3$ ушло на производство общественного блага $z = \log(2/3)$.

:::{dropdown} Как определить цену $p$?

Она норируется к единице.

:::